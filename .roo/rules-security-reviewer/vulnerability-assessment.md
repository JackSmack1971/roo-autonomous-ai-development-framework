# Security Review & Vulnerability Assessment

## Security Code Review Standards

### Critical Security Review Points
- [ ] **Input Validation**: All user inputs validated and sanitized
- [ ] **Authentication Logic**: Secure credential handling and session management
- [ ] **Authorization Controls**: Proper access control checks before operations
- [ ] **Data Protection**: Sensitive data encrypted at rest and in transit
- [ ] **Error Handling**: No sensitive information leaked in error messages
- [ ] **Logging Security**: Security events logged without exposing secrets

### Automated Vulnerability Detection
**IMMEDIATELY flag these patterns for remediation:**

**SQL Injection Risks:**
- String concatenation for database queries
- Dynamic query building without parameterization
- User input directly embedded in SQL statements

**Authentication Vulnerabilities:**
- Hardcoded credentials or API keys
- Weak password requirements or storage
- Session management without proper expiration
- Missing multi-factor authentication for privileged operations

**Data Exposure Risks:**
- Sensitive data in log files or error messages
- Unencrypted storage of personal or financial data
- Missing access controls on sensitive operations
- Data transmitted without encryption

## Security Testing Integration

### Penetration Testing Coordination
```json
{
  "tool": "new_task",
  "args": {
    "mode": "sparc-autonomous-adversary",
    "objective": "Comprehensive penetration testing of security-reviewed components",
    "context": {
      "security_controls_implemented": "[controls that need adversarial validation]",
      "attack_surface_analysis": "[potential attack vectors and entry points]",
      "business_logic_vulnerabilities": "[complex workflows requiring security testing]",
      "compliance_validation": "[regulatory security requirements to verify]"
    },
    "priority": "high",
    "acceptance_criteria": [
      "all_security_controls_validated_under_attack",
      "no_critical_vulnerabilities_discovered",
      "business_logic_security_confirmed",
      "compliance_security_requirements_verified"
    ]
  }
}
```

### Security Remediation Task Creation
**When vulnerabilities are discovered:**
```json
{
  "tool": "new_task",
  "args": {
    "mode": "sparc-code-implementer", 
    "objective": "URGENT: Security vulnerability remediation",
    "context": {
      "vulnerability_details": "[specific security issues identified]",
      "severity_assessment": "[critical|high|medium based on exploitability and impact]",
      "remediation_approach": "[recommended fixes and security controls]",
      "testing_requirements": "[security tests to validate fixes]"
    },
    "priority": "critical",
    "acceptance_criteria": [
      "vulnerability_completely_remediated",
      "security_controls_properly_implemented",
      "remediation_verified_through_testing",
      "no_new_vulnerabilities_introduced"
    ]
  }
}
```
